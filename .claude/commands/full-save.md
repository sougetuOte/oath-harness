# フルセーブ

プロジェクトルートの `SESSION_STATE.md` + 論理グループ別 git commit + git push + Daily 記録。
一日の終わりや大きな区切りで使用する。

**コンテキストガード**: 残量が 15% 未満の場合、フルセーブはコンテキストを大量消費するため `/quick-save` にフォールバックしてユーザーに通知すること。

## 1. コンテキスト残量チェック

残量 15% 未満と判断した場合:
```
--- フルセーブ中断 ---
コンテキスト残量が少ないため /quick-save に切り替えます。
git commit/push と Daily は次セッションで実行してください。
---
```
→ /quick-save の手順を実行して終了。

## 2. SESSION_STATE.md を書き出す（プロジェクトルート直下）

以下の内容を **簡潔に** 記録（各項目は箇条書き数行で十分）:

### 完了タスク
- 今回のセッションで完了した作業を箇条書き

### 進行中タスク
- 作業途中のものとその現在の状態
- 次に何をすべきか

### 次のステップ
- 次セッションで最初にやるべきこと（優先順位付き）

### 変更ファイル一覧
- 今回変更したファイルのパス一覧

### 未解決の問題
- 残っている課題、確認事項（なければ「なし」）

### コンテキスト情報
- 現在のgitブランチ
- 関連するSPEC/ADR/設計書ファイル名

## 3. git commit（論理グループ別）

1. `git status` で変更ファイルを確認
2. 変更を **論理的なグループに分類**（最大3グループ）
   - 例: 「機能A の実装」「テスト追加」「ドキュメント更新」「設定変更」
   - 関連するファイルをまとめて1コミットにする
3. グループごとに `git add` + `git commit`
   - コミットメッセージは変更の目的がわかる形式で
   - 追跡しやすいように prefix を使う（feat/fix/docs/chore 等）
4. 変更がない場合はスキップ

### コミットのガイドライン
- 1グループ = 1コミット（追跡しやすさ優先）
- 3グループを超える場合は無理に分けず、関連性で統合
- 秘密情報（.env, credentials 等）は除外

## 4. git push

`git push` を実行。リモートが設定されていない場合はスキップして報告。

## 5. Daily 記録

`docs/daily/YYYY-MM-DD.md` に以下を記録:

### 本日完了
- 完了したタスク（1〜3項目）

### 明日の最優先
- 次にやるべきこと（1項目）

### 課題・気づき
- あれば最大1つ

## 6. 完了報告

以下を表示:

```
--- full-save 完了 ---
SESSION_STATE.md: 更新済み
git commit: X件のコミット
git push: 完了 / スキップ
Daily: docs/daily/YYYY-MM-DD.md

再開方法:
  claude -c  （直前セッション続行）
  claude     （新規セッション）

再開後: 「SESSION_STATE.md を読んで前回の続きから」
---
```
